---
title: HTTP、导航请求流程
autoGroup-1: 浏览器
sidebarDepth: 0
autoSort: 997
---

## HTTP请求流程
HTTP 协议，是建立在 TCP 连接基础之上的。**HTTP 是一种允许浏览器向服务器获取资源的协议，是 Web 的基础**，通常由浏览器发起请求，用来获取不同类型的文件，例如 HTML 文件、CSS 文件、JavaScript 文件、图片、视频等。此外，**HTTP 也是浏览器使用最广的协议**。    

**HTTP 的内容是通过 TCP 的传输数据阶段来实现的。**      

TCP 和 HTTP 的关系：
![TCP 和 HTTP 的关系示意图](@assets/img/note-web/http-tcp.png)      


## 导航请求流程
用户发出 URL 请求到页面开始解析的这个过程，就叫做导航。    

#### 从输入url到页面展示发生了什么？
1. 用户输入搜索内容（使用默认浏览器合成新的带搜索关键字的 URL）或者URL并回车；
2. 浏览器进程检查url，组装协议，构成完整的url；   
3. 浏览器进程通过进程间通信（IPC）把url请求发送给网络进程
4. 网络进程接收到url请求后检查本地缓存是否缓存了该请求资源，如果有则将该资源返回给浏览器进程；    
5. 如果没有，网络进程向web服务器发起http请求（网络请求），请求流程如下：               
   - 进行 DNS 解析，以获取请求域名的服务器 IP 地址。如果请求协议是 HTTPS，那么还需要建立 TLS 连接。             
   - 利用 IP 地址和服务器建立 TCP 连接。
   - 浏览器端会构建请求行、请求头等信息，并把和该域名相关的 Cookie 等数据附加到请求头中，然后向服务器发送构建的请求信息。
   - 服务器响应后，网络进程接收响应数据（包括响应行、响应头和响应体等信息）。

6. 网络进程解析响应流程；
   - 检查状态码，如果是301/302，则需要重定向，从Location自动中读取地址，重新进行第4步
   - 检查响应类型Content-Type，如果是字节流类型，则将该请求提交给下载管理器，该导航流程结束，不再进行后续的渲染，如果是html则通知浏览器进程准备渲染进程准备进行渲染。   
7. 准备渲染进程；
   Chrome 的默认策略是，每个标签对应一个渲染进程。但如果从一个页面打开了另一个新页面，而新页面和当前页面属于同一站点的话，那么新页面会复用父页面的渲染进程。官方把这个默认策略叫 process-per-site-instance。    
8. 提交数据、更新状态；(完整的导航流程就“走”完了)            
   浏览器进程将网络进程接收到的 HTML 数据提交给渲染进程；    
   渲染进程接收完数据后，向浏览器发送“确认提交”；          
   浏览器进程接收到确认消息后更新浏览器界面状态：安全、地址栏url、前进后退的历史状态、更新web页面。       
9. 页面渲染；    

